n=100,
w1=9/10,
a1=20,
a2=10,
b1=35,
b2=3
)
plot_Bernoulli_param <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 1.5;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
theta_prior_pdf <- BernoulliModel_PDF_mixprior(x_theta, Kmax=Kmax, w=w, a=a, b=b) ;
theta_post_pdf <- BernoulliModel_PDF_mixposterior(x_theta, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b);
loglik <- exp(loglik_fun(x_theta,n,r))
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
y_max <- max(theta_post_pdf, theta_prior_pdf)
par(mfrow=c(1,1))
plot(x_theta,
#theta_post_pdf,
loglik,
type = "l",
main='Posterior vs Prior PDF',
xlab = expression(theta),
ylab = expression(paste(pi(theta,"|",x[1:n]), " and " ,pi(theta))),
col="blue" ,
# xlim=c(0,1),
# ylim=c(0,y_max+1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
# lines(x_theta,
#       theta_prior_pdf,
#       col= "green",
#       cex.lab=fntsz,
#       cex.axis=fntsz,
#       cex.main=fntsz,
#       cex.sub=fntsz) ;
#
# lines(x_theta,
#       loglik,
#       col= "red",
#       cex.lab=fntsz,
#       cex.axis=fntsz,
#       cex.main=fntsz,
#       cex.sub=fntsz) ;
abline(v=theta,
col="purple")
legend('topright',
c('Posterior','Prior',expression(paste(theta, " real value"))),
bg="transparent",
lty=c(1,1),
lwd=c(2.5,2.5),
col=c('blue','green','purple'),
cex=fntsz
)
}
plot_Bernoulli_pred <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 1.5;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
par(mfrow=c(1,1))
barplot(xnew_pred_pdf,
names = x_pred,
xlab = "x",
main = "Predictive PMF",
ylab = expression(paste("p(",x[n+1], "|", x["1:n"] , ")")),
ylim=c(0,1.1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
}
plot_Bernoulli_param(theta=0.8,
n=100,
w1=9/10,
a1=20,
a2=10,
b1=35,
b2=3
)
plot_Bernoulli_param(theta=0.8,
n=10,
w1=9/10,
a1=20,
a2=10,
b1=35,
b2=3
)
plot_Bernoulli_param(theta=0.8,
n=3,
w1=9/10,
a1=20,
a2=10,
b1=35,
b2=3
)
?plot
plot_Bernoulli_param <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 3;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
theta_prior_pdf <- BernoulliModel_PDF_mixprior(x_theta, Kmax=Kmax, w=w, a=a, b=b) ;
theta_post_pdf <- BernoulliModel_PDF_mixposterior(x_theta, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b);
loglik <- exp(loglik_fun(x_theta,n,r))
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
y_max <- max(theta_post_pdf, theta_prior_pdf)
par(mfrow=c(1,1))
plot(x_theta,
theta_post_pdf,
#loglik,
type = "b",
main='Posterior vs Prior PDF',
xlab = expression(theta),
ylab = expression(paste(pi(theta,"|",x[1:n]), " and " ,pi(theta))),
col="blue" ,
# xlim=c(0,1),
# ylim=c(0,y_max+1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
lines(x_theta,
theta_prior_pdf,
type = "l",
col= "green",
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
lines(x_theta,
loglik,
col= "red",
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
abline(v=theta,
col="purple")
legend('topright',
c('Posterior','Prior',expression(paste(theta, " real value"))),
bg="transparent",
lty=c(1,1),
lwd=c(2.5,2.5),
col=c('blue','green','purple'),
cex=fntsz
)
}
plot_Bernoulli_pred <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 1.5;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
par(mfrow=c(1,1))
barplot(xnew_pred_pdf,
names = x_pred,
xlab = "x",
main = "Predictive PMF",
ylab = expression(paste("p(",x[n+1], "|", x["1:n"] , ")")),
ylim=c(0,1.1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
}
plot_Bernoulli_param(theta=0.8,
n=3,
w1=9/10,
a1=20,
a2=10,
b1=35,
b2=3
)
plot_Bernoulli_param <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 3;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
theta_prior_pdf <- BernoulliModel_PDF_mixprior(x_theta, Kmax=Kmax, w=w, a=a, b=b) ;
theta_post_pdf <- BernoulliModel_PDF_mixposterior(x_theta, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b);
loglik <- exp(loglik_fun(x_theta,n,r))
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
y_max <- max(theta_post_pdf, theta_prior_pdf)
par(mfrow=c(1,1))
plot(x_theta,
theta_post_pdf,
#loglik,
type = "b",
main='Posterior vs Prior PDF',
xlab = expression(theta),
ylab = expression(paste(pi(theta,"|",x[1:n]), " and " ,pi(theta))),
col="blue" ,
# xlim=c(0,1),
# ylim=c(0,y_max+1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
lines(x_theta,
theta_prior_pdf,
type = "l",
col= "green",
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
lines(x_theta,
loglik,
col= "purple",
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
abline(v=theta,
col="red")
legend('topright',
c('Posterior','Prior','Likelihood',expression(paste(theta, " real value"))),
bg="transparent",
lty=c(1,1),
lwd=c(2.5,2.5),
col=c('blue','green','purple','red'),
cex=fntsz
)
}
plot_Bernoulli_pred <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 1.5;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
par(mfrow=c(1,1))
barplot(xnew_pred_pdf,
names = x_pred,
xlab = "x",
main = "Predictive PMF",
ylab = expression(paste("p(",x[n+1], "|", x["1:n"] , ")")),
ylim=c(0,1.1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
}
plot_Bernoulli_param(theta=0.8,
n=3,
w1=9/10,
a1=20,
a2=10,
b1=35,
b2=3
)
plot_Bernoulli_param <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 2;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
theta_prior_pdf <- BernoulliModel_PDF_mixprior(x_theta, Kmax=Kmax, w=w, a=a, b=b) ;
theta_post_pdf <- BernoulliModel_PDF_mixposterior(x_theta, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b);
loglik <- exp(loglik_fun(x_theta,n,r))
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
y_max <- max(theta_post_pdf, theta_prior_pdf)
par(mfrow=c(1,1))
plot(x_theta,
theta_post_pdf,
#loglik,
type = "b",
lwd=3,
main='Posterior vs Prior PDF',
xlab = expression(theta),
ylab = expression(paste(pi(theta,"|",x[1:n]), " and " ,pi(theta))),
col="blue" ,
# xlim=c(0,1),
# ylim=c(0,y_max+1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
lines(x_theta,
theta_prior_pdf,
type = "l",
lwd=3,
col= "green",
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
lines(x_theta,
loglik,
lwd=3,
col= "purple",
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
abline(v=theta,
lwd=3,
col="red")
legend('topright',
c('Posterior','Prior','Likelihood',expression(paste(theta, " real value"))),
bg="transparent",
lty=c(1,1),
lwd=c(2.5,2.5),
col=c('blue','green','purple','red'),
cex=fntsz
)
}
plot_Bernoulli_pred <- function(theta=0.5, n=10,
Kmax=2,
w1=0.5,
a1=10, a2=15,
b1=20, b2=15) {
# theta=0.5
# n=10
# Kmax=2
# w1=0.5
# w2=0.2
# a1=10
# a2=20
# b1=20
# b2=10
w2 = 1-w1 ;
w = c(w1,w2)
a = c(a1,a2)
b = c(b1,b2)
fntsz <- 1.5;
op <- par(cex = fntsz)
obs <-get_randnumb(n) ;
obs <- 1*(obs<theta) ;
r <- BernoulliModel_SufStat(obs,n) ;
x_theta <- seq(from = 0, to = 1, length.out = 50) ;
x_pred <- c(0,1) ;
xnew_pred_pdf <- c(BernoulliModel_PDF_mixpred(0, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b),
BernoulliModel_PDF_mixpred(1, r=r,  n=n, Kmax=Kmax, w=w, a=a, b=b));
#layout( cbind( matrix(1,4,4), matrix(2,4,4), matrix(3,4,4) , matrix(4,4,4) ) )
par(mfrow=c(1,1))
barplot(xnew_pred_pdf,
names = x_pred,
xlab = "x",
main = "Predictive PMF",
ylab = expression(paste("p(",x[n+1], "|", x["1:n"] , ")")),
ylim=c(0,1.1),
cex.lab=fntsz,
cex.axis=fntsz,
cex.main=fntsz,
cex.sub=fntsz) ;
}
plot_Bernoulli_param(theta=0.8,
n=3,
w1=9/10,
a1=20,
a2=10,
b1=35,
b2=3
)
